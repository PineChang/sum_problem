<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0046)http://www.cnblogs.com/xdp-gacl/p/3969249.html -->
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-cn"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>javaweb学习总结(四十五)——监听器(Listener)学习二 - 孤傲苍狼 - 博客园</title>
<link type="text/css" rel="stylesheet" href="./javaweb学习总结(四十五)——监听器(Listener)学习二 - 孤傲苍狼 - 博客园_files/blog-common.css">
<link id="MainCss" type="text/css" rel="stylesheet" href="./javaweb学习总结(四十五)——监听器(Listener)学习二 - 孤傲苍狼 - 博客园_files/bundle-SimpleClear.css">
<link type="text/css" rel="stylesheet" href="./javaweb学习总结(四十五)——监听器(Listener)学习二 - 孤傲苍狼 - 博客园_files/133816.css">
<link title="RSS" type="application/rss+xml" rel="alternate" href="http://www.cnblogs.com/xdp-gacl/rss">
<link title="RSD" type="application/rsd+xml" rel="EditURI" href="http://www.cnblogs.com/xdp-gacl/rsd.xml">
<link type="application/wlwmanifest+xml" rel="wlwmanifest" href="http://www.cnblogs.com/xdp-gacl/wlwmanifest.xml">
<script src="./javaweb学习总结(四十五)——监听器(Listener)学习二 - 孤傲苍狼 - 博客园_files/jquery.js" type="text/javascript"></script>  
<script type="text/javascript">var currentBlogApp = 'xdp-gacl', cb_enable_mathjax=false;</script>
<script src="./javaweb学习总结(四十五)——监听器(Listener)学习二 - 孤傲苍狼 - 博客园_files/blog-common.js" type="text/javascript"></script>
</head>
<body>
<a name="top"></a>
<div id="page_begin_html"><!-- Baidu Button BEGIN -->
<!--<div style="display: none" id="__document_write_ajax_div-1"></div><script type="text/javascript" id="bdshare_js" data="type=slide&amp;img=0&amp;pos=right&amp;uid=6507240" >window['__document_write_ajax_callbacks__']['1']();</script>
<div style="display: none" id="__document_write_ajax_div-2"></div><script type="text/javascript" id="bdshell_js">window['__document_write_ajax_callbacks__']['2']();</script>
<div style="display: none" id="__document_write_ajax_div-3"></div><script type="text/javascript">window['__document_write_ajax_callbacks__']['3']();</script>-->
<!-- Baidu Button END -->

<!--添加博客目录-->


<!--
<head>

DIY 博客全文界面的推荐、反对、加关注、返回顶部、快速评论等小功能的集成

<div style="display: none" id="__document_write_ajax_div-5"></div><script type="text/javascript">window['__document_write_ajax_callbacks__']['5']();</script>
</head>
--></div><script>load_page_begin_html();</script>

<div id="main">
<div id="header">
<h1><a id="Header1_HeaderTitle" href="http://www.cnblogs.com/xdp-gacl/">孤傲苍狼</a></h1>
<p id="tagline">只为成功找方法，不为失败找借口！</p></div>

<div id="post_detail">
<div class="post">
    <h2 class="postTitle"><a id="cb_post_title_url" href="./javaweb学习总结(四十五)——监听器(Listener)学习二 - 孤傲苍狼 - 博客园_files/javaweb学习总结(四十五)——监听器(Listener)学习二 - 孤傲苍狼 - 博客园.html">javaweb学习总结(四十五)——监听器(Listener)学习二</a></h2>
    <div class="postText"><div id="cnblogs_post_body"><h2>一、监听域对象中属性的变更的监听器</h2>
<p>　　域对象中属性的变更的事件监听器就是用来监听 ServletContext, HttpSession, HttpServletRequest 这三个对象中的属性变更信息事件的监听器。<br>　　这三个监听器接口分别是ServletContextAttributeListener, HttpSessionAttributeListener 和ServletRequestAttributeListener，这三个接口中都定义了三个方法来处理被监听对象中的属性的增加，删除和替换的事件，同一个事件在这三个接口中对应的方法名称完全相同，只是接受的参数类型不同。</p>
<h3>1.1、attributeAdded 方法</h3>
<p>　　当向被监听对象中增加一个属性时，web容器就调用事件监听器的attributeAdded方法进行响应，这个方法接收一个事件类型的参数，监听器可以通过这个参数来获得正在增加属性的域对象和被保存到域中的属性对象<br>　　各个域属性监听器中的完整语法定义为：</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> attributeAdded(ServletContextAttributeEvent scae)
</span><span style="color: #008080;">2</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> attributeReplaced(HttpSessionBindingEvent  hsbe)
</span><span style="color: #008080;">3</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> attributeRmoved(ServletRequestAttributeEvent srae)</pre>
</div>
<h3>1.2、attributeRemoved 方法</h3>
<p>　　当删除被监听对象中的一个属性时，web容器调用事件监听器的attributeRemoved方法进行响应<br>　　各个域属性监听器中的完整语法定义为：</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> attributeRemoved(ServletContextAttributeEvent scae)
</span><span style="color: #008080;">2</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> attributeRemoved (HttpSessionBindingEvent  hsbe)
</span><span style="color: #008080;">3</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> attributeRemoved (ServletRequestAttributeEvent srae)</pre>
</div>
<h3>1.3、attributeReplaced 方法</h3>
<p>　　当监听器的域对象中的某个属性被替换时，web容器调用事件监听器的attributeReplaced方法进行响应<br>　　各个域属性监听器中的完整语法定义为：</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> attributeReplaced(ServletContextAttributeEvent scae)
</span><span style="color: #008080;">2</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> attributeReplaced (HttpSessionBindingEvent  hsbe)
</span><span style="color: #008080;">3</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> attributeReplaced (ServletRequestAttributeEvent srae)</pre>
</div>
<h3>1.4、ServletContextAttributeListener监听器范例：</h3>
<p>　　编写ServletContextAttributeListener监听器监听ServletContext域对象的属性值变化情况，代码如下：</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> me.gacl.web.listener;
</span><span style="color: #008080;"> 2</span> 
<span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.text.MessageFormat;
</span><span style="color: #008080;"> 4</span> 
<span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.servlet.ServletContextAttributeEvent;
</span><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.servlet.ServletContextAttributeListener;
</span><span style="color: #008080;"> 7</span> 
<span style="color: #008080;"> 8</span> <span style="color: #008000;">/**</span>
<span style="color: #008080;"> 9</span> <span style="color: #008000;">* @ClassName: MyServletContextAttributeListener
</span><span style="color: #008080;">10</span> <span style="color: #008000;">* @Description: ServletContext域对象中属性的变更的事件监听器
</span><span style="color: #008080;">11</span> <span style="color: #008000;">* </span><span style="color: #808080;">@author</span><span style="color: #008000;">: 孤傲苍狼
</span><span style="color: #008080;">12</span> <span style="color: #008000;">* @date: 2014-9-11 下午10:53:04
</span><span style="color: #008080;">13</span> <span style="color: #008000;">*
</span><span style="color: #008080;">14</span> <span style="color: #008000;">*/</span> 
<span style="color: #008080;">15</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MyServletContextAttributeListener <span style="color: #0000ff;">implements</span>
<span style="color: #008080;">16</span> <span style="color: #000000;"><span style="color: #ff0000;"><strong>        ServletContextAttributeListener</strong></span> {
</span><span style="color: #008080;">17</span> 
<span style="color: #008080;">18</span> <span style="color: #000000;">    @Override
</span><span style="color: #008080;">19</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> attributeAdded(ServletContextAttributeEvent scab) {
</span><span style="color: #008080;">20</span>         String str =<span style="color: #000000;">MessageFormat.format(
</span><span style="color: #008080;">21</span>                 "ServletContext域对象中添加了属性:{0}，属性值是:{1}"
<span style="color: #008080;">22</span> <span style="color: #000000;">                ,scab.getName()
</span><span style="color: #008080;">23</span> <span style="color: #000000;">                ,scab.getValue());
</span><span style="color: #008080;">24</span> <span style="color: #000000;">        System.out.println(str);
</span><span style="color: #008080;">25</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">26</span> 
<span style="color: #008080;">27</span> <span style="color: #000000;">    @Override
</span><span style="color: #008080;">28</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> attributeRemoved(ServletContextAttributeEvent scab) {
</span><span style="color: #008080;">29</span>         String str =<span style="color: #000000;">MessageFormat.format(
</span><span style="color: #008080;">30</span>                 "ServletContext域对象中删除属性:{0}，属性值是:{1}"
<span style="color: #008080;">31</span> <span style="color: #000000;">                ,scab.getName()
</span><span style="color: #008080;">32</span> <span style="color: #000000;">                ,scab.getValue());
</span><span style="color: #008080;">33</span> <span style="color: #000000;">        System.out.println(str);
</span><span style="color: #008080;">34</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">35</span> 
<span style="color: #008080;">36</span> <span style="color: #000000;">    @Override
</span><span style="color: #008080;">37</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> attributeReplaced(ServletContextAttributeEvent scab) {
</span><span style="color: #008080;">38</span>         String str =<span style="color: #000000;">MessageFormat.format(
</span><span style="color: #008080;">39</span>                 "ServletContext域对象中替换了属性:{0}的值"
<span style="color: #008080;">40</span> <span style="color: #000000;">                ,scab.getName());
</span><span style="color: #008080;">41</span> <span style="color: #000000;">        System.out.println(str);
</span><span style="color: #008080;">42</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">43</span> }</pre>
</div>
<p>　　在web.xml文件中注册监听器</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span>  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">listener</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">2</span>       <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">description</span><span style="color: #0000ff;">&gt;</span>MyServletContextAttributeListener监听器<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">description</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">3</span>       <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">listener-class</span><span style="color: #0000ff;">&gt;</span>me.gacl.web.listener.MyServletContextAttributeListener<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">listener-class</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">4</span>   <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">listener</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>　　编写ServletContextAttributeListenerTest.jsp测试页面</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="background-color: #ffff00; color: #000000;">&lt;%</span><span style="background-color: #f5f5f5; color: #000000;">@ page language</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">java</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;"> pageEncoding</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">UTF-8</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #ffff00; color: #000000;">%&gt;</span>
<span style="color: #008080;"> 2</span> <span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE HTML</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 3</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">html</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 4</span>   <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">head</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 5</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">title</span><span style="color: #0000ff;">&gt;</span>ServletContextAttributeListener监听器测试<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">title</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 6</span>   <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">head</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 7</span>   
<span style="color: #008080;"> 8</span>   <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 9</span>         <span style="background-color: #ffff00; color: #000000;">&lt;%</span>
<span style="color: #008080;">10</span>            <span style="background-color: #f5f5f5; color: #000000;">//</span><span style="background-color: #f5f5f5; color: #000000;">往application域对象中添加属性
</span><span style="color: #008080;">11</span> <span style="background-color: #f5f5f5; color: #000000;">           application.setAttribute(</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">name</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;">, </span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">孤傲苍狼</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;">);
</span><span style="color: #008080;">12</span>           <span style="background-color: #f5f5f5; color: #000000;">//</span><span style="background-color: #f5f5f5; color: #000000;">替换application域对象中name属性的值
</span><span style="color: #008080;">13</span> <span style="background-color: #f5f5f5; color: #000000;">           application.setAttribute(</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">name</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;">, </span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">gacl</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;">);
</span><span style="color: #008080;">14</span>            <span style="background-color: #f5f5f5; color: #000000;">//</span><span style="background-color: #f5f5f5; color: #000000;">移除application域对象中name属性
</span><span style="color: #008080;">15</span> <span style="background-color: #f5f5f5; color: #000000;">           application.removeAttribute(</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">name</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;">);
</span><span style="color: #008080;">16</span>            <span style="background-color: #ffff00; color: #000000;">%&gt;</span>
<span style="color: #008080;">17</span>   <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">18</span> <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">html</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>运行结果如下：</p>
<p>　　<img style="border: 1px solid black;" src="./javaweb学习总结(四十五)——监听器(Listener)学习二 - 孤傲苍狼 - 博客园_files/131214219028703.gif" alt=""></p>
<p>　　从运行结果中可以看到，ServletContextListener监听器成功监听到了ServletContext域对象(application)中的属性值的变化情况。</p>
<h3>1.5、ServletRequestAttributeListener和HttpSessionAttributeListener监听器范例：</h3>
<p>　　编写监听器监听HttpSession和HttpServletRequest域对象的属性值变化情况，代码如下：</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> me.gacl.web.listener;
</span><span style="color: #008080;"> 2</span> 
<span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.text.MessageFormat;
</span><span style="color: #008080;"> 4</span> 
<span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.servlet.ServletRequestAttributeEvent;
</span><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.servlet.ServletRequestAttributeListener;
</span><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.servlet.http.HttpSessionAttributeListener;
</span><span style="color: #008080;"> 8</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.servlet.http.HttpSessionBindingEvent;
</span><span style="color: #008080;"> 9</span> 
<span style="color: #008080;">10</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MyRequestAndSessionAttributeListener <span style="color: #0000ff;">implements</span>
<span style="color: #008080;">11</span> <span style="color: #000000;">        HttpSessionAttributeListener, ServletRequestAttributeListener {
</span><span style="color: #008080;">12</span> 
<span style="color: #008080;">13</span> <span style="color: #000000;">    @Override
</span><span style="color: #008080;">14</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> attributeAdded(ServletRequestAttributeEvent srae) {
</span><span style="color: #008080;">15</span>         String str =<span style="color: #000000;">MessageFormat.format(
</span><span style="color: #008080;">16</span>                 "ServletRequest域对象中添加了属性:{0}，属性值是:{1}"
<span style="color: #008080;">17</span> <span style="color: #000000;">                ,srae.getName()
</span><span style="color: #008080;">18</span> <span style="color: #000000;">                ,srae.getValue());
</span><span style="color: #008080;">19</span> <span style="color: #000000;">        System.out.println(str);
</span><span style="color: #008080;">20</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">21</span> 
<span style="color: #008080;">22</span> <span style="color: #000000;">    @Override
</span><span style="color: #008080;">23</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> attributeRemoved(ServletRequestAttributeEvent srae) {
</span><span style="color: #008080;">24</span>         String str =<span style="color: #000000;">MessageFormat.format(
</span><span style="color: #008080;">25</span>                 "ServletRequest域对象中删除属性:{0}，属性值是:{1}"
<span style="color: #008080;">26</span> <span style="color: #000000;">                ,srae.getName()
</span><span style="color: #008080;">27</span> <span style="color: #000000;">                ,srae.getValue());
</span><span style="color: #008080;">28</span> <span style="color: #000000;">        System.out.println(str);
</span><span style="color: #008080;">29</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">30</span> 
<span style="color: #008080;">31</span> <span style="color: #000000;">    @Override
</span><span style="color: #008080;">32</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> attributeReplaced(ServletRequestAttributeEvent srae) {
</span><span style="color: #008080;">33</span>         String str =<span style="color: #000000;">MessageFormat.format(
</span><span style="color: #008080;">34</span>                 "ServletRequest域对象中替换了属性:{0}的值"
<span style="color: #008080;">35</span> <span style="color: #000000;">                ,srae.getName());
</span><span style="color: #008080;">36</span> <span style="color: #000000;">        System.out.println(str);
</span><span style="color: #008080;">37</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">38</span> 
<span style="color: #008080;">39</span> <span style="color: #000000;">    @Override
</span><span style="color: #008080;">40</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> attributeAdded(HttpSessionBindingEvent se) {
</span><span style="color: #008080;">41</span>         String str =<span style="color: #000000;">MessageFormat.format(
</span><span style="color: #008080;">42</span>                 "HttpSession域对象中添加了属性:{0}，属性值是:{1}"
<span style="color: #008080;">43</span> <span style="color: #000000;">                ,se.getName()
</span><span style="color: #008080;">44</span> <span style="color: #000000;">                ,se.getValue());
</span><span style="color: #008080;">45</span> <span style="color: #000000;">        System.out.println(str);
</span><span style="color: #008080;">46</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">47</span> 
<span style="color: #008080;">48</span> <span style="color: #000000;">    @Override
</span><span style="color: #008080;">49</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> attributeRemoved(HttpSessionBindingEvent se) {
</span><span style="color: #008080;">50</span>         String str =<span style="color: #000000;">MessageFormat.format(
</span><span style="color: #008080;">51</span>                 "HttpSession域对象中删除属性:{0}，属性值是:{1}"
<span style="color: #008080;">52</span> <span style="color: #000000;">                ,se.getName()
</span><span style="color: #008080;">53</span> <span style="color: #000000;">                ,se.getValue());
</span><span style="color: #008080;">54</span> <span style="color: #000000;">        System.out.println(str);
</span><span style="color: #008080;">55</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">56</span> 
<span style="color: #008080;">57</span> <span style="color: #000000;">    @Override
</span><span style="color: #008080;">58</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> attributeReplaced(HttpSessionBindingEvent se) {
</span><span style="color: #008080;">59</span>         String str =<span style="color: #000000;">MessageFormat.format(
</span><span style="color: #008080;">60</span>                 "HttpSession域对象中替换了属性:{0}的值"
<span style="color: #008080;">61</span> <span style="color: #000000;">                ,se.getName());
</span><span style="color: #008080;">62</span> <span style="color: #000000;">        System.out.println(str);
</span><span style="color: #008080;">63</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">64</span> }</pre>
</div>
<p>　　在web.xml文件中注册监听器</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span>  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">listener</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">2</span>       <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">description</span><span style="color: #0000ff;">&gt;</span>MyRequestAndSessionAttributeListener监听器<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">description</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">3</span>       <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">listener-class</span><span style="color: #0000ff;">&gt;</span>me.gacl.web.listener.MyRequestAndSessionAttributeListener<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">listener-class</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">4</span>   <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">listener</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>　　编写RequestAndSessionAttributeListenerTest.jsp测试页面</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="background-color: #ffff00; color: #000000;">&lt;%</span><span style="background-color: #f5f5f5; color: #000000;">@ page language</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">java</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;"> pageEncoding</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">UTF-8</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #ffff00; color: #000000;">%&gt;</span>
<span style="color: #008080;"> 2</span> <span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE HTML</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 3</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">html</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 4</span>   <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">head</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 5</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">title</span><span style="color: #0000ff;">&gt;</span>RequestAndSessionAttributeListener监听器测试<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">title</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 6</span>   <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">head</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 7</span>   
<span style="color: #008080;"> 8</span>   <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 9</span>     <span style="background-color: #ffff00; color: #000000;">&lt;%</span>
<span style="color: #008080;">10</span>            <span style="background-color: #f5f5f5; color: #000000;">//</span><span style="background-color: #f5f5f5; color: #000000;">往session域对象中添加属性
</span><span style="color: #008080;">11</span> <span style="background-color: #f5f5f5; color: #000000;">           session.setAttribute(</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">aa</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;">, </span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">bb</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;">);
</span><span style="color: #008080;">12</span>           <span style="background-color: #f5f5f5; color: #000000;">//</span><span style="background-color: #f5f5f5; color: #000000;">替换session域对象中aa属性的值
</span><span style="color: #008080;">13</span> <span style="background-color: #f5f5f5; color: #000000;">           session.setAttribute(</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">aa</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;">, </span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">xx</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;">);
</span><span style="color: #008080;">14</span>            <span style="background-color: #f5f5f5; color: #000000;">//</span><span style="background-color: #f5f5f5; color: #000000;">移除session域对象中aa属性
</span><span style="color: #008080;">15</span> <span style="background-color: #f5f5f5; color: #000000;">           session.removeAttribute(</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">aa</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;">);
</span><span style="color: #008080;">16</span>            
<span style="color: #008080;">17</span>            <span style="background-color: #f5f5f5; color: #000000;">//</span><span style="background-color: #f5f5f5; color: #000000;">往request域对象中添加属性
</span><span style="color: #008080;">18</span> <span style="background-color: #f5f5f5; color: #000000;">           request.setAttribute(</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">aa</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;">, </span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">bb</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;">);
</span><span style="color: #008080;">19</span>           <span style="background-color: #f5f5f5; color: #000000;">//</span><span style="background-color: #f5f5f5; color: #000000;">替换request域对象中aa属性的值
</span><span style="color: #008080;">20</span> <span style="background-color: #f5f5f5; color: #000000;">           request.setAttribute(</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">aa</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;">, </span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">xx</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;">);
</span><span style="color: #008080;">21</span>            <span style="background-color: #f5f5f5; color: #000000;">//</span><span style="background-color: #f5f5f5; color: #000000;">移除request域对象中aa属性
</span><span style="color: #008080;">22</span> <span style="background-color: #f5f5f5; color: #000000;">           request.removeAttribute(</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">aa</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;">);
</span><span style="color: #008080;">23</span>     <span style="background-color: #ffff00; color: #000000;">%&gt;</span>
<span style="color: #008080;">24</span>   <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">25</span> <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">html</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>　　运行结果如下：</p>
<p>　　<img style="border: 1px solid black;" src="./javaweb学习总结(四十五)——监听器(Listener)学习二 - 孤傲苍狼 - 博客园_files/131826164491751.gif" alt=""></p>
<p>　　从运行结果中可以看到，HttpSessionAttributeListener监听器和ServletRequestAttributeListener成功监听到了HttpSession域对象和HttpServletRequest域对象的属性值变化情况。</p>
<h2>二、感知Session绑定的事件监听器</h2>
<p>　　保存在Session域中的对象可以有多种状态：绑定(session.setAttribute("bean",Object))到Session中；从 Session域中解除(session.removeAttribute("bean"))绑定；随Session对象持久化到一个存储设备中；随Session对象从一个存储设备中恢复<br>　　Servlet 规范中定义了<span style="color: #ff0000;"><strong>两个特殊的监听器接口"HttpSessionBindingListener和HttpSessionActivationListener"来帮助JavaBean 对象了解自己在Session域中的这些状态： ，实现这两个接口的类不需要 web.xml 文件中进行注册</strong></span>。</p>
<h3>2.1、HttpSessionBindingListener接口</h3>
<p>　　<span style="color: #ff0000;"><strong>实现了HttpSessionBindingListener接口的JavaBean对象可以感知自己被绑定到Session中和 Session中删除的事件</strong></span><br>　　当对象被绑定到HttpSession对象中时，web服务器调用该对象的void valueBound(HttpSessionBindingEvent event)方法<br>　　当对象从HttpSession对象中解除绑定时，web服务器调用该对象的void valueUnbound(HttpSessionBindingEvent event)方法</p>
<p>范例：</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> me.gacl.domain;
</span><span style="color: #008080;"> 2</span> 
<span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.servlet.http.HttpSessionBindingEvent;
</span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.servlet.http.HttpSessionBindingListener;
</span><span style="color: #008080;"> 5</span> 
<span style="color: #008080;"> 6</span> <span style="color: #008000;">/**</span>
<span style="color: #008080;"> 7</span> <span style="color: #008000;">* @ClassName: JavaBeanDemo1
</span><span style="color: #008080;"> 8</span> <span style="color: #008000;">* @Description: 
</span><span style="color: #008080;"> 9</span> <span style="color: #008000;">*   实现了HttpSessionBindingListener接口的 JavaBean对象可以感知自己被绑定到 Session中和从Session中删除的事件
</span><span style="color: #008080;">10</span> <span style="color: #008000;">    当对象被绑定到 HttpSession 对象中时，web 服务器调用该对象的  void valueBound(HttpSessionBindingEvent event) 方法
</span><span style="color: #008080;">11</span> <span style="color: #008000;">    当对象从 HttpSession 对象中解除绑定时，web 服务器调用该对象的 void valueUnbound(HttpSessionBindingEvent event)方法
</span><span style="color: #008080;">12</span> 
<span style="color: #008080;">13</span> <span style="color: #008000;">* </span><span style="color: #808080;">@author</span><span style="color: #008000;">: 孤傲苍狼
</span><span style="color: #008080;">14</span> <span style="color: #008000;">* @date: 2014-9-11 下午11:14:54
</span><span style="color: #008080;">15</span> <span style="color: #008000;">*
</span><span style="color: #008080;">16</span> <span style="color: #008000;">*/</span> 
<span style="color: #008080;">17</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> JavaBeanDemo1 <span style="color: #0000ff;">implements</span><span style="color: #000000;"><span style="color: #ff0000;"><strong> HttpSessionBindingListener</strong></span> {
</span><span style="color: #008080;">18</span> 
<span style="color: #008080;">19</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> String name;
</span><span style="color: #008080;">20</span>     
<span style="color: #008080;">21</span> <span style="color: #000000;">    @Override
</span><span style="color: #008080;">22</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> valueBound(HttpSessionBindingEvent event) {
</span><span style="color: #008080;">23</span>         System.out.println(name+"被加到session中了"<span style="color: #000000;">);
</span><span style="color: #008080;">24</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">25</span> 
<span style="color: #008080;">26</span> <span style="color: #000000;">    @Override
</span><span style="color: #008080;">27</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> valueUnbound(HttpSessionBindingEvent event) {
</span><span style="color: #008080;">28</span>         System.out.println(name+"被session踢出来了"<span style="color: #000000;">);
</span><span style="color: #008080;">29</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">30</span> 
<span style="color: #008080;">31</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> String getName() {
</span><span style="color: #008080;">32</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> name;
</span><span style="color: #008080;">33</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">34</span> 
<span style="color: #008080;">35</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setName(String name) {
</span><span style="color: #008080;">36</span>         <span style="color: #0000ff;">this</span>.name =<span style="color: #000000;"> name;
</span><span style="color: #008080;">37</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">38</span> 
<span style="color: #008080;">39</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> JavaBeanDemo1(String name) {
</span><span style="color: #008080;">40</span>         <span style="color: #0000ff;">this</span>.name =<span style="color: #000000;"> name;
</span><span style="color: #008080;">41</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">42</span> }</pre>
</div>
<p>　　上述的JavaBeanDemo1这个javabean实现了HttpSessionBindingListener接口，那么这个JavaBean对象可以感知自己被绑定到Session中和从Session中删除的这两个操作，测试代码如下：</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="background-color: #ffff00; color: #000000;">&lt;%</span><span style="background-color: #f5f5f5; color: #000000;">@ page language</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">java</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;"> pageEncoding</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">UTF-8</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #ffff00; color: #000000;">%&gt;</span>
<span style="color: #008080;"> 2</span> <span style="background-color: #ffff00; color: #000000;">&lt;%</span><span style="background-color: #f5f5f5; color: #000000;">@page import</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;"> me.gacl.domain.JavaBeanDemo1</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #ffff00; color: #000000;">%&gt;</span>
<span style="color: #008080;"> 3</span> <span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE HTML</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 4</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">html</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 5</span>   <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">head</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 6</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">title</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">title</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 7</span>   <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">head</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 8</span>   
<span style="color: #008080;"> 9</span>   <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">10</span>     <span style="background-color: #ffff00; color: #000000;">&lt;%</span> 
<span style="color: #008080;">11</span>         <span style="background-color: #f5f5f5; color: #000000;">//</span><span style="background-color: #f5f5f5; color: #000000;">将javabean对象绑定到Session中
</span><span style="color: #008080;">12</span> <span style="background-color: #f5f5f5; color: #000000;">        session.setAttribute(</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">bean</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #0000ff;">new</span><span style="background-color: #f5f5f5; color: #000000;"> JavaBeanDemo1(</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">孤傲苍狼</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;">));
</span><span style="color: #008080;">13</span>         <span style="background-color: #f5f5f5; color: #000000;">//</span><span style="background-color: #f5f5f5; color: #000000;">从Session中删除javabean对象
</span><span style="color: #008080;">14</span> <span style="background-color: #f5f5f5; color: #000000;">        session.removeAttribute(</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">bean</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;">);
</span><span style="color: #008080;">15</span>     <span style="background-color: #ffff00; color: #000000;">%&gt;</span>
<span style="color: #008080;">16</span>   <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">17</span> <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">html</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>　　运行结果如下：</p>
<p>　　<img style="border: 1px solid black;" src="./javaweb学习总结(四十五)——监听器(Listener)学习二 - 孤傲苍狼 - 博客园_files/131846231211739.gif" alt=""></p>
<h3>2.2、HttpSessionActivationListener接口</h3>
<p>　　<span style="color: #ff0000;"><strong>实现了HttpSessionActivationListener接口的JavaBean对象可以感知自己被活化(反序列化)和钝化(序列化)的事件</strong></span><br>　　当绑定到HttpSession对象中的javabean对象将要随HttpSession对象被钝化<span style="color: #ff0000;"><strong>(序列化)</strong></span>之前，web服务器调用该javabean对象的void sessionWillPassivate(HttpSessionEvent event) 方法。这样javabean对象就可以知道自己将要和HttpSession对象一起被序列化(钝化)到硬盘中.<br>　　当绑定到HttpSession对象中的javabean对象将要随HttpSession对象被活化<span style="color: #ff0000;"><strong>(反序列化)</strong></span>之后，web服务器调用该javabean对象的void sessionDidActive(HttpSessionEvent event)方法。这样javabean对象就可以知道自己将要和 HttpSession对象一起被反序列化(活化)回到内存中</p>
<p>范例：</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> me.gacl.domain;
</span><span style="color: #008080;"> 2</span> 
<span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.io.Serializable;
</span><span style="color: #008080;"> 4</span> 
<span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.servlet.http.HttpSessionActivationListener;
</span><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.servlet.http.HttpSessionEvent;
</span><span style="color: #008080;"> 7</span> 
<span style="color: #008080;"> 8</span> <span style="color: #008000;">/**</span>
<span style="color: #008080;"> 9</span> <span style="color: #008000;">* @ClassName: JavaBeanDemo2
</span><span style="color: #008080;">10</span> <span style="color: #008000;">* @Description: 
</span><span style="color: #008080;">11</span> <span style="color: #008000;">    实现了HttpSessionActivationListener接口的 JavaBean 对象可以感知自己被活化和钝化的事件
</span><span style="color: #008080;">12</span> <span style="color: #008000;">    活化:javabean对象和Session一起被反序列化(活化)到内存中。
</span><span style="color: #008080;">13</span> <span style="color: #008000;">    钝化:javabean对象存在Session中，当服务器把session序列化到硬盘上时，如果Session中的javabean对象实现了Serializable接口
</span><span style="color: #008080;">14</span> <span style="color: #008000;">    那么服务器会把session中的javabean对象一起序列化到硬盘上，javabean对象和Session一起被序列化到硬盘中的这个操作称之为钝化
</span><span style="color: #008080;">15</span> <span style="color: #008000;">    如果Session中的javabean对象没有实现Serializable接口，那么服务器会先把Session中没有实现Serializable接口的javabean对象移除
</span><span style="color: #008080;">16</span> <span style="color: #008000;">    然后再把Session序列化(钝化)到硬盘中
</span><span style="color: #008080;">17</span> <span style="color: #008000;">    当绑定到 HttpSession对象中的javabean对象将要随 HttpSession对象被钝化之前，
</span><span style="color: #008080;">18</span> <span style="color: #008000;">    web服务器调用该javabean对象对象的 void sessionWillPassivate(HttpSessionEvent event)方法
</span><span style="color: #008080;">19</span> <span style="color: #008000;">    这样javabean对象就可以知道自己将要和 HttpSession对象一起被序列化(钝化)到硬盘中
</span><span style="color: #008080;">20</span> <span style="color: #008000;">    当绑定到HttpSession对象中的javabean对象将要随 HttpSession对象被活化之后，
</span><span style="color: #008080;">21</span> <span style="color: #008000;">    web服务器调用该javabean对象的 void sessionDidActive(HttpSessionEvent event)方法
</span><span style="color: #008080;">22</span> <span style="color: #008000;">    这样javabean对象就可以知道自己将要和 HttpSession对象一起被反序列化(活化)回到内存中
</span><span style="color: #008080;">23</span> <span style="color: #008000;">* </span><span style="color: #808080;">@author</span><span style="color: #008000;">: 孤傲苍狼
</span><span style="color: #008080;">24</span> <span style="color: #008000;">* @date: 2014-9-11 下午11:22:35
</span><span style="color: #008080;">25</span> <span style="color: #008000;">*
</span><span style="color: #008080;">26</span> <span style="color: #008000;">*/</span> 
<span style="color: #008080;">27</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> JavaBeanDemo2 <span style="color: #0000ff;">implements</span><span style="color: #000000;"> HttpSessionActivationListener,
</span><span style="color: #008080;">28</span> <span style="color: #000000;">        Serializable {
</span><span style="color: #008080;">29</span> 
<span style="color: #008080;">30</span>      
<span style="color: #008080;">31</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">long</span> serialVersionUID = 7589841135210272124L<span style="color: #000000;">;
</span><span style="color: #008080;">32</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> String name;
</span><span style="color: #008080;">33</span>     
<span style="color: #008080;">34</span> <span style="color: #000000;">    @Override
</span><span style="color: #008080;">35</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> sessionWillPassivate(HttpSessionEvent se) {
</span><span style="color: #008080;">36</span>         
<span style="color: #008080;">37</span>         System.out.println(name+"和session一起被序列化(钝化)到硬盘了，session的id是："+<span style="color: #000000;">se.getSession().getId());
</span><span style="color: #008080;">38</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">39</span> 
<span style="color: #008080;">40</span> <span style="color: #000000;">    @Override
</span><span style="color: #008080;">41</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> sessionDidActivate(HttpSessionEvent se) {
</span><span style="color: #008080;">42</span>         System.out.println(name+"和session一起从硬盘反序列化(活化)回到内存了，session的id是："+<span style="color: #000000;">se.getSession().getId());
</span><span style="color: #008080;">43</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">44</span> 
<span style="color: #008080;">45</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> String getName() {
</span><span style="color: #008080;">46</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> name;
</span><span style="color: #008080;">47</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">48</span> 
<span style="color: #008080;">49</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setName(String name) {
</span><span style="color: #008080;">50</span>         <span style="color: #0000ff;">this</span>.name =<span style="color: #000000;"> name;
</span><span style="color: #008080;">51</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">52</span> 
<span style="color: #008080;">53</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> JavaBeanDemo2(String name) {
</span><span style="color: #008080;">54</span>         <span style="color: #0000ff;">this</span>.name =<span style="color: #000000;"> name;
</span><span style="color: #008080;">55</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">56</span> }</pre>
</div>
<p>　　为了观察绑定到HttpSession对象中的javabean对象随HttpSession对象一起被钝化到硬盘上和从硬盘上重新活化回到内存中的的过程，我们需要借助tomcat服务器帮助我们完成HttpSession对象的钝化和活化过程，具体做法如下：</p>
<p>　　在WebRoot\META-INF文件夹下创建一个context.xml文件，如下所示：</p>
<p>　　</p></div></div></div></div></div></body></html>